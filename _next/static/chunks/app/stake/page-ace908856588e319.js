(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9831],{67869:function(e,t,s){Promise.resolve().then(s.bind(s,79789))},79789:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var l=s(57437),r=s(72e3),a=s(2265),i=s(88726),n=s(42921);function c(e,t){let[s,l="0"]=e.split("."),r=s.startsWith("-");if(r&&(s=s.slice(1)),l=l.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${l}`))&&(s=`${BigInt(s)+1n}`),l="";else if(l.length>t){let[e,r,a]=[l.slice(0,t-1),l.slice(t-1,t),l.slice(t)],i=Math.round(Number(`${r}.${a}`));(l=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(l=l.slice(1),s=`${BigInt(s)+1n}`),l=l.slice(0,t)}else l=l.padEnd(t,"0");return BigInt(`${r?"-":""}${s}${l}`)}var d=s(94956),o=s(26735),u=s(53860),m=s(25937),x=s(33628),h=s(79320),b=s(762),g=s(49235),N=s(61954);async function f(e,t={}){let{chainId:s,...l}=t,r=e.getClient({chainId:s}),a=(0,N.s)(r,g.Q,"getBlock");return{...await a(l),chainId:r.chain.id}}function j(){let e="The amount must be an integer multiple of ".concat(x.t),t=(0,d.Z)(),{address:s}=(0,o.m)(),[g,N]=(0,a.useState)({}),{data:j}=(0,u.K)({address:s}),p=(0,a.useMemo)(()=>j?Number((0,n.b)(j.value,j.decimals)):0,[j]),{data:v}=(0,m.Kx)("userSummary",[s]),[w,y]=(0,a.useState)(0);(0,a.useEffect)(()=>{v?y(Number(v.available.toString())*x.t):y(0)},[v]);let[k,S]=(0,a.useState)(0);(0,a.useEffect)(()=>{v?S(Number(v.unlocked.toString())*x.t):S(0)},[v]);let[C,B]=(0,a.useState)([]),[P,E]=(0,a.useState)([]),{data:Q}=(0,m.Kx)("userInQueue",[s]),I=(0,a.useCallback)(async(e,s)=>{let{timestamp:l}=await f(t,{blockNumber:e.endBlock});"inQueue"===s&&E(t=>{let s=[...t],r={...e,blockNumber:e.endBlock.toString(),vote:Number(e.votePower.toString())*x.t,timestamp:l.toString()},a=s.findIndex(t=>t.endBlock===e.endBlock);return -1!==a?s.splice(a,1,r):s.push(r),s}),"outQueue"===s&&X(t=>{let s=[...t],r={...e,blockNumber:e.endBlock.toString(),vote:Number(e.votePower.toString())*x.t,timestamp:l.toString()},a=s.findIndex(t=>t.endBlock===e.endBlock);return -1!==a?s.splice(a,1,r):s.push(r),s})},[t]);(0,a.useEffect)(()=>{Q?B(Q):B([])},[Q]),(0,a.useEffect)(()=>{C.length>0&&C.forEach(e=>{I(e,"inQueue")})},[C,I]);let{data:Z}=(0,m.Kx)("userOutQueue",[s]),[$,M]=(0,a.useState)([]),[T,X]=(0,a.useState)([]);(0,a.useEffect)(()=>{Z?M(Z):M([])},[Z]),(0,a.useEffect)(()=>{$.length>0&&$.forEach(e=>{I(e,"outQueue")})},[$,I]);let[F,_]=(0,a.useState)(!1),[A,U]=(0,a.useState)(""),K="inQueue"===A?P.sort((e,t)=>Number(e.timestamp)-Number(t.timestamp)):"outQueue"===A?T.sort((e,t)=>Number(e.timestamp)-Number(t.timestamp)):[],[W,H]=(0,a.useState)(!1),[L,O]=(0,a.useState)(""),z=(0,a.useMemo)(()=>Math.floor(p/x.t)*x.t,[p]),D=(0,m.Xv)(),q=async()=>{if(Number(L)>z){i.ZP.error("The maximum available balance is ".concat(z)),O(String(z));return}let t=Number(L)/x.t;if(!Number.isInteger(t)||t<=0){i.ZP.error(e),O("");return}H(!0);try{let e=Number(L)/x.t,t=await D(c(L,j.decimals),e);H(!1),O(""),N({show:!0,type:"success",content:"交易已提交，请等待确认",scanHash:t})}catch(e){console.log(e),i.ZP.error(e.details),H(!1)}},[R,V]=(0,a.useState)(!1),[G,J]=(0,a.useState)(""),Y=(0,m.aw)(),ee=async()=>{if(Number(G)>w){i.ZP.error("The maximum available amount is ".concat(w)),J(String(w));return}let t=Number(G)/x.t;if(!Number.isInteger(t)||t<=0){i.ZP.error(e),J("");return}V(!0);try{let e=Number(G)/x.t,t=await Y(c(G,j.decimals),e);V(!1),J(""),N({show:!0,type:"success",content:"交易已提交，请等待确认",scanHash:t})}catch(e){console.log(e),i.ZP.error(e.details),V(!1)}},[et,es]=(0,a.useState)(!1),[el,er]=(0,a.useState)(""),ea=(0,m.A4)(),ei=async()=>{if(Number(el)>k){i.ZP.error("The maximum available amount is ".concat(k)),J(String(k));return}let t=Number(el)/x.t;if(!Number.isInteger(t)||t<=0){i.ZP.error(e),er("");return}es(!0);try{let e=Number(el)/x.t,t=await ea(c(el,j.decimals),e);es(!1),N({show:!0,type:"success",content:"交易已提交，请等待确认",scanHash:t})}catch(e){console.log(e),i.ZP.error(e.details),es(!1)}},en=e=>{1===e&&O(String(z)),2===e&&J(String(w)),3===e&&er(String(k))},ec=e=>{_(!0),U(e)};return(0,a.useEffect)(()=>{F?document.body.classList.add("lock"):document.body.classList.remove("lock")},[F]),(0,l.jsxs)("div",{className:"pb-5",children:[(0,l.jsx)(r.Z,{}),(0,l.jsx)("h2",{className:"slogan",children:"ABC Pool V2"}),(0,l.jsxs)("div",{className:"mx-auto px-5 grid gap-y-5 md:max-w-5xl md:grid-cols-2 md:gap-x-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-sky-400 text-2xl",children:"Stake CFX"}),(0,l.jsxs)("div",{className:"layout",children:[(0,l.jsxs)("div",{className:"layout-row",children:[(0,l.jsx)("div",{children:"Balance"}),(0,l.jsxs)("div",{className:"text-newBlue",children:[(0,b.qz)(p,5)," CFX"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"layout-row",children:[(0,l.jsx)("div",{children:"Amount"}),(0,l.jsx)("input",{value:L,type:"number",min:x.t,step:x.t,placeholder:"Please enter",className:"w-full mx-4 text-right text-sm text-newBlue bg-transparent outline-none",onChange:e=>O(e.target.value)}),(0,l.jsx)("button",{className:"text-newBlue",onClick:()=>en(1),children:"Max"})]}),(0,l.jsx)("div",{className:"text-xs text-red-500 text-right mt-1",children:e})]})]}),(0,l.jsxs)("button",{disabled:W,className:"w-full bg-newBlue text-white px-2 h-9 mt-5 rounded-full flex items-center justify-center disabled:cursor-not-allowed disabled:opacity-65",onClick:q,children:[W?(0,l.jsx)("i",{className:"ri-loader-2-fill animate-spin mr-1"}):"","Stake"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center text-yellow-600",children:[(0,l.jsx)("h2",{className:"text-2xl",children:"Unstakeable CFX"}),(0,l.jsx)("button",{onClick:()=>ec("inQueue"),children:"Details"})]}),(0,l.jsxs)("div",{className:"layout",children:[(0,l.jsxs)("div",{className:"layout-row",children:[(0,l.jsx)("div",{children:"Unstakeable"}),(0,l.jsxs)("div",{className:"text-newBlue",children:[w," CFX"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"layout-row",children:[(0,l.jsx)("div",{children:"Amount"}),(0,l.jsx)("input",{value:G,type:"number",min:x.t,step:x.t,placeholder:"Please enter",className:"w-full mx-4 text-right text-sm text-yellow-600 bg-transparent outline-none",onChange:e=>J(e.target.value)}),(0,l.jsx)("button",{className:"text-newBlue",onClick:()=>en(2),children:"Max"})]}),(0,l.jsx)("div",{className:"text-xs text-red-500 text-right mt-1",children:e})]})]}),(0,l.jsxs)("button",{disabled:R,className:"w-full bg-yellow-600 text-white px-2 h-10 mt-5 rounded-full flex items-center justify-center disabled:cursor-not-allowed disabled:opacity-65",onClick:ee,children:[R?(0,l.jsx)("i",{className:"ri-loader-2-fill animate-spin mr-1"}):"","Unstake"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center text-green-600",children:[(0,l.jsx)("h2",{className:"text-2xl",children:"Withdraw CFX"}),(0,l.jsx)("button",{onClick:()=>ec("outQueue"),children:"Details"})]}),(0,l.jsxs)("div",{className:"layout",children:[(0,l.jsxs)("div",{className:"layout-row",children:[(0,l.jsx)("div",{children:"Withdrawable"}),(0,l.jsxs)("div",{className:"text-newBlue",children:[k," CFX"]})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"layout-row",children:[(0,l.jsx)("div",{children:"Amount"}),(0,l.jsx)("input",{value:el,type:"number",min:x.t,step:x.t,placeholder:"Please enter",className:"w-full mx-4 text-right text-sm text-green-600 bg-transparent outline-none",onChange:e=>er(e.target.value)}),(0,l.jsx)("button",{className:"text-newBlue",onClick:()=>en(3),children:"Max"})]}),(0,l.jsx)("div",{className:"text-xs text-red-500 text-right mt-1",children:e})]})]}),(0,l.jsxs)("button",{disabled:et,className:"w-full bg-green-600 text-white px-2 h-10 mt-5 rounded-full flex items-center justify-center disabled:cursor-not-allowed disabled:opacity-65",onClick:ei,children:[et?(0,l.jsx)("i",{className:"ri-loader-2-fill animate-spin mr-1"}):"","Withdraw"]})]})]}),(0,l.jsxs)("div",{className:"mx-auto mt-6 mb-10 px-5 md:max-w-5xl",children:[(0,l.jsx)("h2",{className:"text-stone-200 text-xl",children:"Stake Rules"}),(0,l.jsxs)("div",{className:"text-slate-400 leading-6 mt-2",children:[(0,l.jsx)("p",{children:"1. The lock period of Stake/Unstake is 15+2 day(May need another 2~3 hours)."}),(0,l.jsx)("p",{children:"2. The reward will updated every hour."}),(0,l.jsx)("p",{children:"3. The Stake/Unstake CFX amount must be multiple of 1000."}),(0,l.jsx)("p",{children:"4. Performance fee is 8% of the PoS reward."}),(0,l.jsx)("p",{children:"5. The reward can be claimed any time."})]})]}),(0,l.jsx)(h.Z,{setModal:e=>N(e),modalConfig:g}),F?(0,l.jsx)("div",{className:"fixed top-0 bottom-0 left-0 right-0 z-10 bg-[rgba(0,0,0,0.8)] flex justify-center items-center",children:(0,l.jsxs)("div",{className:"bg-gradient-to-tl from-green-900 to-yellow-300 w-full mx-3 px-3 py-8 md:p-8 rounded-xl relative md:w-4/5 max-w-2xl",children:[(0,l.jsx)("button",{className:"absolute top-2 right-2",onClick:()=>_(!1),children:(0,l.jsx)("i",{className:"ri-close-line text-2xl text-white"})}),(0,l.jsxs)("div",{className:"text-xl font-bold text-center md:text-left",children:["inQueue"===A?"Locking":"outQueue"===A?"Unlocking":""," votes"]}),(0,l.jsxs)("div",{className:"mt-5 text-white border-b border-gray-200/60 text-sm md:text-base",children:[(0,l.jsxs)("div",{className:"grid grid-cols-[130px_1fr] md:grid-cols-2 border-t border-l border-gray-200/60",children:[(0,l.jsx)("div",{className:"px-4 py-2 border-r border-gray-200/60",children:"Amount (CFX)"}),(0,l.jsx)("div",{className:"px-4 py-2 border-r border-gray-200/60",children:"BlockTime"})]}),(0,l.jsxs)("div",{className:"max-h-96 md:max-h-[600px] overflow-y-auto thin-scrollbar",children:[K.map(e=>(0,l.jsxs)("div",{className:"grid grid-cols-[130px_1fr] md:grid-cols-2 border-t border-l border-gray-200/60",children:[(0,l.jsx)("div",{className:"px-4 py-2 border-r border-gray-200/60 h-full",children:e.vote}),(0,l.jsx)("div",{className:"px-4 py-2 border-r border-gray-200/60",children:(0,b.mr)(e.timestamp)})]},e.timestamp)),0===K.length?(0,l.jsx)("div",{className:"text-center py-3 border border-b-0 border-gray-200/60",children:"No data"}):null]})]})]})}):null]})}}},function(e){e.O(0,[9472,477,554,289,2971,7023,1744],function(){return e(e.s=67869)}),_N_E=e.O()}]);